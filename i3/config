#############################################################################
# i3 config file (v4)
#
# Please see https://i3wm.org/docs/userguide.html for a complete reference!
#############################################################################

##########
# colors #
##########

# get color from xressource configuration - variable_name xressource_color fallback

# special
set_from_resource $foreground foreground #C6C6C6
set_from_resource $background background #1C1C1C
set_from_resource $cursorColor cursorColor #C6C6C6

# black
set_from_resource $black1 color0 #303030
set_from_resource $black2 color8 #444444
set $trueblack #000000

# red
set_from_resource $red1 color1 #d75f5f
set_from_resource $red2 color9 #d75f5f

# green
set_from_resource $green1 color2 #87AF87
set_from_resource $green2 color10 #87AF87

# yellow
set_from_resource $yellow1 color3 #ffd75f
set_from_resource $yellow2 color11 #ffd75f

# blue
set_from_resource $blue1 color4 #87afd7
set_from_resource $blue2 color12 #87afd7

# magenta
set_from_resource $cyan1 color5 #afafd7
set_from_resource $cyan2 color13 #afafd7

# cyan
set_from_resource $cyan1 color6 #afd7ff
set_from_resource $cyan2 color14 #afd7ff

# white
set_from_resource $white1 color7 #4E4E4E
set_from_resource $white2 color15 #ffffff

##########
# DESIGN #
##########

# hide borders
hide_edge_borders both

# class                 border  backgr. text    indicator child_border
client.focused          #333333 $white1 $white2 #285577
client.focused_inactive #333333 $background $foreground #484e50
client.unfocused        #333333 #222222 #888888 #292d2e   #222222
client.urgent           $red1   $red1   $white2 $red1     $red1
client.placeholder      #000000 #0c0c0c $white2 #000000   #0c0c0c

title_align	center

set $mod		Mod4
set $config		~/.config/i3/
set $scripts	~/.config/i3/scripts

font pango:DejaVuSans, FontAwesome 10

# fix unsupported XEmbedded trayicons on electron and similar engines
# see: https://git.sr.ht/~steef/snixembed
exec --no-startup-id snixembed --fork > /tmp/snixembed.log 2>&1 

# configure touchpad
exec --no-startup-id $scripts/touchpad.sh

# lock the screen after 5 minutes
exec --no-startup-id xset s on; xset 120
exec --no-startup-id xss-lock --transfer-sleep-lock -- $scripts/lock-screen.sh
exec --no-startup-id pasystray
exec --no-startup-id copyq
exec --no-startup-id dropbox start
exec --no-startup-id run_keybase -a
exec --no-startup-id insync-headless start
exec --no-startup-id alacritty -t Work 
exec_always --no-startup-id $scripts/wallpaper.sh
exec --no-startup-id ~/.joplin/Joplin.AppImage

# keyboard layout us international
exec --no-startup-id setxkbmap -layout us -variant altgr-intl -option nodeadkeys

# Volume Controls
set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume	exec pactl set-sink-volume @DEFAULT_SINK@ +10% && $refresh_i3status
bindsym XF86AudioLowerVolume	exec pactl set-sink-volume @DEFAULT_SINK@ -10% && $refresh_i3status
bindsym XF86AudioMute			exec pactl set-sink-mute @DEFAULT_SINK@ toggle && $refresh_i3status
bindsym XF86AudioMicMute		exec pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status

# Media player controls
bindsym XF86AudioPlay			exec playerctl play
bindsym XF86AudioPause			exec playerctl stop
bindsym XF86AudioNext			exec playerctl next
bindsym XF86AudioPrev			exec playerctl previous

# Use xbacklight to adjust display backlight
bindsym XF86MonBrightnessUp     exec xbacklight -inc 20
bindsym XF86MonBrightnessDown   exec xbacklight -dec 20

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

focus_follows_mouse no

# start a terminal
bindsym $mod+Return exec i3-sensible-terminal

# kill focused window
bindsym $mod+Shift+q kill

# start rofi instead of dmenu (a program launcher)
bindsym $mod+d exec --no-startup-id rofi -show drun
bindsym $mod+F2 exec --no-startup-id rofi -show combi

# change focus
bindsym $mod+h				focus left
bindsym $mod+j				focus down
bindsym $mod+k				focus up
bindsym $mod+l				focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left			focus left
bindsym $mod+Down			focus down
bindsym $mod+Up				focus up
bindsym $mod+Right			focus right

# move focused window
bindsym $mod+Shift+h		move left
bindsym $mod+Shift+j		move down
bindsym $mod+Shift+k		move up
bindsym $mod+Shift+l		move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left		move left
bindsym $mod+Shift+Down		move down
bindsym $mod+Shift+Up		move up
bindsym $mod+Shift+Right	move right

# split in horizontal orientation
bindsym $mod+backslash		split h

# split in vertical orientation
bindsym $mod+underscore		split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen	toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout		stacking
bindsym $mod+w layout		tabbed
bindsym $mod+e layout		toggle split

# toggle tiling / floating
bindsym $mod+Shift+space	floating toggle

# change focus between tiling / floating windows
bindsym $mod+space			focus mode_toggle

# focus the parent container
bindsym $mod+a				focus parent

# Define names for default workspaces for which we configure key bindings later on.
# We use variables to avoid repeating the names in multiple places.
set $web        "1: web"
set $dev		"2:  dev"
set $terms      "3: terms"
set $multimedia "4: multi"
set $mail       "5: mails"
set $office     "6: office"
set $mindmap    "7: mindmap"
set $ws8		"8"
set $ws9		"9"
set $ws0		"0"

# switch to workspace
bindsym $mod+1 workspace number $web
bindsym $mod+2 workspace number $dev
bindsym $mod+3 workspace number $terms
bindsym $mod+4 workspace number $multimedia
bindsym $mod+5 workspace number $mail
bindsym $mod+6 workspace number $office
bindsym $mod+7 workspace number $mindmap
bindsym $mod+8 workspace number $ws8
bindsym $mod+9 workspace number $ws9
bindsym $mod+0 workspace number $ws10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number $web
bindsym $mod+Shift+2 move container to workspace number $dev
bindsym $mod+Shift+3 move container to workspace number $terms
bindsym $mod+Shift+4 move container to workspace number $multimedia
bindsym $mod+Shift+5 move container to workspace number $mail
bindsym $mod+Shift+6 move container to workspace number $office
bindsym $mod+Shift+7 move container to workspace number $mindmap
bindsym $mod+Shift+8 move container to workspace number $ws8
bindsym $mod+Shift+9 move container to workspace number $ws9
bindsym $mod+Shift+0 move container to workspace number $ws10

# default workspaces output
workspace $web			output HDMI1
workspace $dev			output HDMI1
workspace $terms		output HDMI1
workspace $multimedia	output eDP1
workspace $mail			output eDP1
workspace $office		output eDP1
workspace $mindmap		output eDP1

bindsym $mod+Shift+c		reload
bindsym $mod+Shift+r		restart

# exit i3 (logs you out of your X session)
bindsym $mod+Shift+e		exec i3-msg exit

# lock wall
bindsym $mod+Ctrl+l		exec --no-startup-id $scripts/lock-screen.sh

# modes (see below)
bindsym $mod+r			mode "resize"
bindsym $mod+BackSpace	mode "$mode_system"
bindsym $mod+x			mode "$mode_display"

# resize window (you can also use the mouse for that)
mode "resize" {
        bindsym h		resize shrink width 10 px or 10 ppt
        bindsym j		resize shrink height 10 px or 10 ppt
        bindsym k		resize grow height 10 px or 10 ppt
        bindsym l		resize grow width 10 px or 10 ppt

        bindsym Right	resize grow width 10 px or 10 ppt
        bindsym Up		resize grow height 10 px or 10 ppt
        bindsym Down	resize shrink height 10 px or 10 ppt
        bindsym Left	resize shrink width 10 px or 10 ppt

        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+r mode "default"
}

# lock and logout
mode "$mode_system" {
	# lock screen
	bindsym l       exec --no-startup-id $scripts/lock-screen.sh, mode "default"

	# exit
    bindsym e       exec --no-startup-id i3-msg exit, mode "default"

	# suspend
    bindsym s       exec --no-startup-id $scripts/lock-screen.sh && systemctl suspend, mode "default"

	# hibernate
    bindsym h       exec --no-startup-id $scripts/lock-screen.sh && systemctl hibernate, mode "default"

	# reboot
    bindsym r       exec --no-startup-id systemctl reboot, mode "default"

	# shutdown
    bindsym Ctrl+s  exec --no-startup-id systemctl poweroff -i, mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
set		$mode_system		System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (Ctrl+s) shutdown

# display configuration
mode "$mode_display" {
    bindsym 1 exec --no-startup-id autorandr mirror,		mode "default"
    bindsym 2 exec --no-startup-id autorandr mon-only,		mode "default"
    bindsym 3 exec --no-startup-id autorandr lap-only,		mode "default"
    bindsym 4 exec --no-startup-id autorandr pri_mon-lap,	mode "default"
    bindsym 5 exec --no-startup-id autorandr mon-pri_lap,	mode "default"
    bindsym 6 exec --no-startup-id autorandr pri_lap-mon,	mode "default"
    bindsym 7 exec --no-startup-id autorandr lap-pri_mon,	mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
set $mode_display Display: 1. Mirror - 2. Mon Only - 3. Lap Only - 4. [Mon]->Lap - 5. Mon->[Lap] - 6. [Lap]->Mon - 7. Lap->[Mon]

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
	position top
	tray_output primary

	status_command i3status --config $config/i3status.conf
	colors {
		background			$black2
		statusline			$white2
        separator			$white2 

        focused_workspace  $black2		$black2		$cyan2
        active_workspace   $black2		$black1		$white2
        inactive_workspace $black2		$black2		$foreground
        urgent_workspace   $red1		$red1		$white2
        binding_mode       $black1		$black1		$red2
    }
}

# assign windows to an specific workspace
assign		[class="Google-chrome"]				→	$web
assign		[class="jetbrains-.*"]				→	$dev
assign		[class="Code"]						→	$office
assign		[class="Alacritty" title="Work"]	→	$terms
assign		[class="Joplin" instance="joplin"]	→ $office
assign		[class="libreoffice"]				→ $office
for_window	[class="Spotify"] move to workspace		$multimedia

# styles
for_window [class="^Pavucontrol$"] floating enable
for_window [class="^Arandr$"] floating enable
for_window [class="^copyq$"] floating enable
for_window [class="^Keybase$"] floating enable
for_window [class="^JetBrains Toolbox$"] floating enable
for_window [title="tracker - .*"] floating enable
for_window [class="^.*"] border pixel 2
for_window [class="jetbrains-idea" title="win0"] floating enable;
for_window [class="jetbrains-goland" title="win0"] floating enable;
for_window [class="Anki" title="Profiles"] floating enable;

# scratchpads
for_window [class="Alacritty" title="htop_scratchpad"] move to scratchpad, border none
bindsym $mod+Shift+p [class="Alacritty" title="htop_scratchpad"] scratchpad show
exec alacritty -t htop_scratchpad -e htop

bindsym $mod+Shift+minus move scratchpad

# 
# gaps: only works with i3-gaps instead of i3
#
gaps inner 15
set $mode_gaps Gaps: (o)uter, (i)nner, (h)orizontal, (v)ertical, (t)op, (r)ight, (b)ottom, (l)eft
set $mode_gaps_outer Outer Gaps: +|-|0 (local), Shift + +|-|0 (global)
set $mode_gaps_inner Inner Gaps: +|-|0 (local), Shift + +|-|0 (global)
set $mode_gaps_horiz Horizontal Gaps: +|-|0 (local), Shift + +|-|0 (global)
set $mode_gaps_verti Vertical Gaps: +|-|0 (local), Shift + +|-|0 (global)
set $mode_gaps_top Top Gaps: +|-|0 (local), Shift + +|-|0 (global)
set $mode_gaps_right Right Gaps: +|-|0 (local), Shift + +|-|0 (global)
set $mode_gaps_bottom Bottom Gaps: +|-|0 (local), Shift + +|-|0 (global)
set $mode_gaps_left Left Gaps: +|-|0 (local), Shift + +|-|0 (global)
bindsym $mod+Shift+g mode "$mode_gaps"

mode "$mode_gaps" {
        bindsym o      mode "$mode_gaps_outer"
        bindsym i      mode "$mode_gaps_inner"
        bindsym h      mode "$mode_gaps_horiz"
        bindsym v      mode "$mode_gaps_verti"
        bindsym t      mode "$mode_gaps_top"
        bindsym r      mode "$mode_gaps_right"
        bindsym b      mode "$mode_gaps_bottom"
        bindsym l      mode "$mode_gaps_left"
        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}

mode "$mode_gaps_outer" {
        bindsym plus  gaps outer current plus 5
        bindsym minus gaps outer current minus 5
        bindsym 0     gaps outer current set 0

        bindsym Shift+plus  gaps outer all plus 5
        bindsym Shift+minus gaps outer all minus 5
        bindsym Shift+0     gaps outer all set 0

        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}
mode "$mode_gaps_inner" {
        bindsym plus  gaps inner current plus 5
        bindsym minus gaps inner current minus 5
        bindsym 0     gaps inner current set 0

        bindsym Shift+plus  gaps inner all plus 5
        bindsym Shift+minus gaps inner all minus 5
        bindsym Shift+0     gaps inner all set 0

        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}
mode "$mode_gaps_horiz" {
        bindsym plus  gaps horizontal current plus 5
        bindsym minus gaps horizontal current minus 5
        bindsym 0     gaps horizontal current set 0

        bindsym Shift+plus  gaps horizontal all plus 5
        bindsym Shift+minus gaps horizontal all minus 5
        bindsym Shift+0     gaps horizontal all set 0

        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}
mode "$mode_gaps_verti" {
        bindsym plus  gaps vertical current plus 5
        bindsym minus gaps vertical current minus 5
        bindsym 0     gaps vertical current set 0

        bindsym Shift+plus  gaps vertical all plus 5
        bindsym Shift+minus gaps vertical all minus 5
        bindsym Shift+0     gaps vertical all set 0

        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}
mode "$mode_gaps_top" {
        bindsym plus  gaps top current plus 5
        bindsym minus gaps top current minus 5
        bindsym 0     gaps top current set 0

        bindsym Shift+plus  gaps top all plus 5
        bindsym Shift+minus gaps top all minus 5
        bindsym Shift+0     gaps top all set 0

        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}
mode "$mode_gaps_right" {
        bindsym plus  gaps right current plus 5
        bindsym minus gaps right current minus 5
        bindsym 0     gaps right current set 0

        bindsym Shift+plus  gaps right all plus 5
        bindsym Shift+minus gaps right all minus 5
        bindsym Shift+0     gaps right all set 0

        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}
mode "$mode_gaps_bottom" {
        bindsym plus  gaps bottom current plus 5
        bindsym minus gaps bottom current minus 5
        bindsym 0     gaps bottom current set 0

        bindsym Shift+plus  gaps bottom all plus 5
        bindsym Shift+minus gaps bottom all minus 5
        bindsym Shift+0     gaps bottom all set 0

        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}
mode "$mode_gaps_left" {
        bindsym plus  gaps left current plus 5
        bindsym minus gaps left current minus 5
        bindsym 0     gaps left current set 0

        bindsym Shift+plus  gaps left all plus 5
        bindsym Shift+minus gaps left all minus 5
        bindsym Shift+0     gaps left all set 0

        bindsym Return mode "$mode_gaps"
        bindsym Escape mode "default"
}
